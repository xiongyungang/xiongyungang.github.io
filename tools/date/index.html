<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>日期工具箱</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root {
  --bg: #0f172a;
  --card: #111827;
  --border: #1f2933;
  --text: #e5e7eb;
  --muted: #9ca3af;
  --primary: #3b82f6;
  --primary-hover: #2563eb;
}
* { box-sizing: border-box; }
body {
  margin: 0;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
  background: linear-gradient(135deg, #020617, #0f172a);
  color: var(--text);
}
.container {
  max-width: 1100px;
  margin: 40px auto;
  padding: 0 16px;
}
h1 {
  text-align: center;
  margin-bottom: 32px;
  font-size: 28px;
}
.grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 20px;
}
.card {
  background: linear-gradient(180deg, #020617, #020617) padding-box,
              linear-gradient(120deg, #1e3a8a, #2563eb) border-box;
  border: 1px solid transparent;
  border-radius: 16px;
  padding: 20px;
  box-shadow: 0 10px 30px rgba(0,0,0,.4);
}
.card h2 {
  margin: 0 0 12px;
  font-size: 18px;
}
.row {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
}
input, select {
  flex: 1;
  min-width: 120px;
  padding: 10px 12px;
  border-radius: 10px;
  border: 1px solid var(--border);
  background: #020617;
  color: var(--text);
}
input::placeholder { color: var(--muted); }
button {
  padding: 10px 16px;
  border-radius: 10px;
  border: none;
  background: linear-gradient(135deg, var(--primary), #60a5fa);
  color: white;
  cursor: pointer;
  font-weight: 600;
}
button:hover { background: linear-gradient(135deg, var(--primary-hover), var(--primary)); }
.result {
  margin-top: 12px;
  padding: 12px;
  border-radius: 10px;
  background: #020617;
  border: 1px dashed var(--border);
  font-size: 14px;
  white-space: pre-line;
}
.footer {
  text-align: center;
  margin-top: 40px;
  color: var(--muted);
  font-size: 13px;
}
</style>
</head>
<body>
<div class="container">
  <h1>日期工具箱</h1>
  <div class="grid">

    <div class="card">
      <h2>日期格式转换</h2>
      <input type="datetime-local" id="dateConvertInput">
      <button onclick="convertDate()">转换</button>
      <div class="result" id="dateConvertResult"></div>
    </div>

    <div class="card">
      <h2>日期加减</h2>
      <div class="row">
        <input type="date" id="dateCalcBase">
        <select id="dateCalcType">
          <option value="days">天</option>
          <option value="months">月</option>
          <option value="years">年</option>
        </select>
        <input type="number" id="dateCalcValue" value="1">
      </div>
      <button onclick="dateAdd()">计算</button>
      <div class="result" id="dateCalcResult"></div>
    </div>

    <div class="card">
      <h2>时间戳转换</h2>
      <div class="row">
        <input type="number" id="timestampInput" placeholder="时间戳">
        <select id="timestampType">
          <option value="ms">毫秒</option>
          <option value="s">秒</option>
        </select>
      </div>
      <div class="row">
        <button onclick="timestampToDate()">→ 日期</button>
        <button onclick="dateToTimestamp()">当前时间戳</button>
      </div>
      <div class="result" id="timestampResult"></div>
    </div>

    <div class="card">
      <h2>日期计算器</h2>
      <div class="row">
        <input type="date" id="diffStart">
        <input type="date" id="diffEnd">
      </div>
      <button onclick="dateDiff()">计算差值</button>
      <div class="result" id="diffResult"></div>
    </div>

    <div class="card">
      <h2>中国农历转换</h2>
      <input type="date" id="lunarInput">
      <button onclick="solarToLunar()">公历 → 农历</button>
      <div class="result" id="lunarResult"></div>
    </div>

  </div>
</div>

<script>
function convertDate() {
  const d = new Date(document.getElementById('dateConvertInput').value);
  document.getElementById('dateConvertResult').innerText =
    `ISO: ${d.toISOString()}\n本地: ${d.toLocaleString()}\nUTC: ${d.toUTCString()}`;
}

function dateAdd() {
  let d = new Date(document.getElementById('dateCalcBase').value);
  let v = parseInt(document.getElementById('dateCalcValue').value);
  let type = document.getElementById('dateCalcType').value;
  if (type === 'days') d.setDate(d.getDate() + v);
  if (type === 'months') d.setMonth(d.getMonth() + v);
  if (type === 'years') d.setFullYear(d.getFullYear() + v);
  document.getElementById('dateCalcResult').innerText = d.toLocaleDateString();
}

function timestampToDate() {
  let ts = Number(document.getElementById('timestampInput').value);
  let type = document.getElementById('timestampType').value;
  if (type === 's') ts *= 1000;
  document.getElementById('timestampResult').innerText = new Date(ts).toLocaleString();
}

function dateToTimestamp() {
  let now = Date.now();
  document.getElementById('timestampResult').innerText = `毫秒: ${now}\n秒: ${Math.floor(now / 1000)}`;
}

function dateDiff() {
  let s = new Date(document.getElementById('diffStart').value);
  let e = new Date(document.getElementById('diffEnd').value);
  let diff = Math.abs(e - s) / 86400000;
  document.getElementById('diffResult').innerText = `相差 ${diff} 天`;
}

const lunarInfo=[0x04bd8,0x04ae0,0x0a570,0x054d5,0x0d260,0x0d950,0x16554,0x056a0,0x09ad0,0x055d2,0x04ae0,0x0a5b6,0x0a4d0,0x0d250,0x1d255,0x0b540,0x0d6a0,0x0ada2,0x095b0,0x14977,0x04970,0x0a4b0,0x0b4b5,0x06a50,0x06d40,0x1ab54,0x02b60,0x09570,0x052f2,0x04970];
function solarToLunar(){let date=new Date(document.getElementById('lunarInput').value);let base=new Date(1900,0,31);let offset=(date-base)/86400000;let year=1900;while(offset>0){offset-=lunarYearDays(year);year++;}if(offset<0){year--;offset+=lunarYearDays(year);}let month=1;let days;while(offset>0){days=lunarMonthDays(year,month);offset-=days;month++;}if(offset<0){month--;offset+=days;}document.getElementById('lunarResult').innerText=`农历：${year}年 ${month}月 ${offset+1}日`;}
function lunarYearDays(y){let sum=348;let info=lunarInfo[y-1900];for(let i=0x8000;i>0x8;i>>=1){sum+=(info&i)?1:0;}return sum+leapDays(y);}function leapDays(y){let info=lunarInfo[y-1900];return leapMonth(y)?((info&0x10000)?30:29):0;}function leapMonth(y){return lunarInfo[y-1900]&0xf;}function lunarMonthDays(y,m){return (lunarInfo[y-1900]&(0x10000>>m))?30:29;}
</script>
</body>
</html>
